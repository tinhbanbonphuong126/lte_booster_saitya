/*! */
/*!
 * yofinity.js v1.0.3 - "Sogeking no shima deeeeeee - One Piece"
 * ~~~~~~~~~~~~~~~~~~
 *
 * Example of use HTML:
 * <a href="http://example.com/page/2" title="Next posts" rel="next">Loading...</a>
 *
 * Example of use JS:
 * $('body').yofinity({
 *     buffer: 1000,
 *     ajaxUrl: 'http://www.example.com/my/ajax/call',
 *     iterator: 1,
 *     navSelector: 'a[rel="next"]',
 *     params: {
 *         param1: 'val1',
 *     },
 *     success: function ($link, response){
 *         $link.before(response);
 *         $link.attr('href', '/page/2');
 *     },
 *     error: function ($link){
 *         $link.remove();
 *     }
 * });
 *
 * ~~~~~~~~~~~~~~~~~~
 * Copyright 2015 Achraf Chouk <achrafchouk@gmail.com>
 */
!function(a){"use strict";var b=function(b,c){
//vars
var d=this;d.$el=b,d.options=a.extend({},c),d.$context=a(d.options.context),
//initialize
d.initialize()};b.prototype.options={},b.prototype.$el=null,b.prototype.$context=null,b.prototype.initialize=function(){var a=this,b=null,c=function(){
//check timer
b&&(clearTimeout(b),b=null),
//set timer
b=setTimeout(function(){a.check()},250)};
//check heights and make a first ajax call if needed
a.$context.get(0).scrollHeight>a.$context.height()&&c(),
//bind scroll event
a.$context.on("scroll",function(a){c()})},b.prototype.check=function(){var b=this,c=b.$el.find(b.options.navSelector),d=b.options.ajaxUrl,e=function(a,c,d){
//check buffer
c>b.options.buffer?b._log(c-b.options.buffer+"px before loading."):b.next(a,d)};
//check children
if(c.length||""!==d){
//update distances
var f=b.$context.scrollTop()+b.$context.height();
//ajax URL only and first
""!==d?e(d,-f,!1):c.length&&
//iterate on all
a.each(c,function(){var b=a(this);e(b.attr("href"),b.offset().top-f,b)})}else b._log("End.")},b.prototype.next=function(b,c){var d=this;
//check href
"#"!==b&&""!==b&&(
//check status
d.$el.attr("data-loading")||
//get ajax call
a.ajax({type:d.options.type.toUpperCase(),data:a.extend(d.options.params,{page:d.options.iterator}),url:b,beforeSend:function(){d._loading()},error:function(){d._error(c)},success:function(a){d.options.iterator++,d._success(a,b,c)}}))},b.prototype._loading=function(){var a=this;
//change status
a.$el.attr("data-loading",!0),a._log("Loading next page."),
//call loading method
"function"==typeof a.options.loading&&a.options.loading($link)},b.prototype._error=function(a){var b=this;
//change status
b.$el.removeAttr("data-loading"),b._log("Error while loading next page."),
//call error method
"function"==typeof b.options.error&&b.options.error(b.options,a)},b.prototype._success=function(a,b,c){var d=this;
//change status
d.$el.removeAttr("data-loading"),d._log("Next page loaded."),
//call success method
"function"==typeof d.options.success&&d.options.success(a,b,c)},b.prototype._log=function(a){var b=this;
//check debug
b.options.debug&&"undefined"!=typeof console&&null!==console&&console.log("Yofinity ~ "+a)};var c={init:function(c){if(!this.length)return!1;var d={ajaxUrl:"",buffer:1e3,context:window,debug:!1,error:null,iterator:1,loading:null,navSelector:'a[rel="next"]',type:"get",params:{},success:null};return this.each(function(){c&&a.extend(d,c),new b(a(this),d)})},update:function(){},destroy:function(){}};a.fn.yofinity=function(b){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.Yofinity"):c.init.apply(this,arguments)}}(window.jQuery);